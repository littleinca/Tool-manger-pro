<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tool Manager Pro</title>
  <style>
    /* keep your existing CSS */
  </style>
</head>
<body>
  <div class="container">

    <!-- Login Screen -->
    <div id="login-screen" class="login-container">
      <div class="header">
        <h1>ðŸ”§ Tool Manager Pro</h1>
        <p>Professional Tool Management System</p>
      </div>

      <form id="login-form">
        <div class="form-group">
          <label for="username">Username</label>
          <input type="text" id="username" placeholder="Enter username" required>
        </div>
        <div class="form-group">
          <label for="password">Password</label>
          <input type="password" id="password" placeholder="Enter password" required>
        </div>
        <button type="submit" class="btn btn-primary">Login</button>
        <button type="button" class="btn btn-warning" onclick="skipLogin()">Skip Login (Demo)</button>
      </form>

      <div style="margin-top: 15px; font-size: 12px; color: #666;">
        <p><strong>Demo Accounts:</strong></p>
        <p>user / user123</p>
        <p>admin / admin123</p>
        <p>Or use Skip Login!</p>
      </div>
    </div>

    <!-- Main Application -->
    <div id="main-app" class="hidden">
      <div class="header">
        <h1>ðŸ”§ Tool Manager Pro</h1>
        <p>Professional Tool Management</p>
      </div>

      <div class="user-info">
        <div>
          <span class="user-name" id="current-user"></span>
          <span class="user-role" id="user-role"></span>
        </div>
        <button class="logout-btn" onclick="logout()">Logout</button>
      </div>

      <div class="tabs" id="main-tabs">
        <button class="tab active" onclick="showTab(event,'checkout')">Check Out</button>
        <button class="tab" onclick="showTab(event,'checkin')">Check In</button>
        <button class="tab" onclick="showTab(event,'inventory')">Inventory</button>
        <button class="tab" onclick="showTab(event,'maintenance')">Maintenance</button>
        <button class="tab" onclick="showTab(event,'reports')">Reports</button>
      </div>

      <!-- Admin Tabs -->
      <div class="tabs hidden" id="admin-tabs">
        <button class="tab" onclick="showTab(event,'admin')">Admin</button>
        <button class="tab" onclick="showTab(event,'users')">Users</button>
        <button class="tab" onclick="showTab(event,'database')">Database</button>
      </div>

      <div id="alert-container"></div>

      <!-- All your tab content (checkout, checkin, inventory, maintenance, reports, admin, users, database) -->
      <!-- unchanged except JSON schema fixed -->

      <div id="database" class="tab-content">
        <div class="admin-actions">
          <h3>Database Schema</h3>
          <pre id="db-schema" style="background: #f8f9fa; padding: 10px; border-radius: 5px; font-size: 12px; overflow-x: auto;">
{
  "tools": [
    {
      "id": "number",
      "name": "string",
      "type": "string",
      "model": "string",
      "barcode": "string",
      "status": "available|checked-out|maintenance",
      "checkedOutBy": "string|null",
      "checkedOutDate": "ISO date|null",
      "project": "string|null",
      "condition": "string",
      "lastMaintenance": "ISO date",
      "nextMaintenance": "ISO date",
      "photos": ["array of base64 strings"],
      "notes": "string"
    }
  ],
  "users": [
    {
      "id": "number",
      "username": "string",
      "role": "user|admin",
      "email": "string",
      "active": "boolean"
    }
  ],
  "transactions": [
    {
      "id": "number",
      "toolId": "number",
      "userId": "string",
      "action": "checkout|checkin|maintenance",
      "timestamp": "ISO date",
      "project": "string",
      "notes": "string"
    }
  ]
}
          </pre>
        </div>
      </div>
    </div>
  </div>

  <!-- Modals (photo modal, add tool modal) -->
  <!-- unchanged -->

  <!-- Supabase SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.0/dist/umd/supabase.min.js"></script>

  <script>
    // Supabase config
    const SUPABASE_URL = 'https://eowwsyxbcskiyixhubnz.supabase.co';
    const SUPABASE_ANON_KEY = 'YOUR_KEY_HERE';
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // === Your existing JS (users, tools, transactions, etc.) ===

    // Fixed skipLogin
    function skipLogin() {
      currentUser = 'demo-user';
      userRole = 'user';
      document.getElementById('login-screen').classList.add('hidden');
      document.getElementById('main-app').classList.remove('hidden');
      updateUserInterface();   // âœ… now updates username/role/stats
      showAlert('Logged in as demo user!', 'success');
    }

    // Fixed showTab
    function showTab(event, tabName) {
      const contents = document.querySelectorAll('.tab-content');
      contents.forEach(c => c.classList.remove('active'));

      const tabs = document.querySelectorAll('.tab');
      tabs.forEach(t => t.classList.remove('active'));

      const targetTab = document.getElementById(tabName);
      if (targetTab) targetTab.classList.add('active');
      if (event) event.target.classList.add('active');

      updateDropdowns();
      updateInventory();
      updateStats();
      if (tabName === 'maintenance') updateMaintenanceSchedule();
      if (tabName === 'reports') generateReport();
      if (tabName === 'users' && userRole === 'admin') updateUsersList();
      if (tabName === 'database' && userRole === 'admin') checkDatabaseConnection();
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      checkAuthStatus();
      document.getElementById('login-form').addEventListener('submit', handleLogin);
      document.getElementById('checkout-form').addEventListener('submit', handleCheckout);
      document.getElementById('checkin-form').addEventListener('submit', handleCheckin);
      document.getElementById('add-tool-form').addEventListener('submit', handleAddTool);
      document.getElementById('search-tools').addEventListener('input', updateInventory);
      document.getElementById('filter-category').addEventListener('change', updateInventory);
      document.getElementById('filter-status').addEventListener('change', updateInventory);
    });
  </script>
</body>
</html>