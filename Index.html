
<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tool Manager Pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 10px;
    }

    .container {
        max-width: 420px;
        margin: 0 auto;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 20px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(10px);
    }

    .header {
        text-align: center;
        margin-bottom: 20px;
    }

    .header h1 {
        color: #333;
        font-size: 24px;
        font-weight: 700;
        margin-bottom: 5px;
    }

    .header p {
        color: #666;
        font-size: 14px;
    }

    .user-info {
        background: #f8f9fa;
        padding: 10px 15px;
        border-radius: 10px;
        margin-bottom: 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .user-name {
        font-weight: 600;
        color: #333;
    }

    .user-role {
        font-size: 12px;
        padding: 4px 8px;
        border-radius: 12px;
        background: #667eea;
        color: white;
    }

    .logout-btn {
        background: #dc3545;
        color: white;
        border: none;
        padding: 6px 12px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 12px;
    }

    .login-container {
        text-align: center;
    }

    .tabs {
        display: flex;
        background: #f8f9fa;
        border-radius: 12px;
        margin-bottom: 15px;
        overflow: hidden;
        flex-wrap: wrap;
    }

    .tab {
        flex: 1;
        padding: 10px 8px;
        text-align: center;
        background: none;
        border: none;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s ease;
        font-size: 12px;
        min-width: 70px;
    }

    .tab.active {
        background: #667eea;
        color: white;
        transform: scale(1.02);
    }

    .tab-content {
        display: none;
    }

    .tab-content.active {
        display: block;
        animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .form-group {
        margin-bottom: 15px;
    }

    .form-group label {
        display: block;
        margin-bottom: 6px;
        font-weight: 600;
        color: #333;
        font-size: 14px;
    }

    .form-group input, .form-group select, .form-group textarea {
        width: 100%;
        padding: 12px;
        border: 2px solid #e9ecef;
        border-radius: 8px;
        font-size: 16px;
        transition: all 0.3s ease;
        background: white;
    }

    .form-group textarea {
        resize: vertical;
        height: 80px;
    }

    .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
        outline: none;
        border-color: #667eea;
        transform: translateY(-1px);
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
    }

    .btn {
        width: 100%;
        padding: 14px;
        border: none;
        border-radius: 10px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-bottom: 8px;
    }

    .btn-primary {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
    }

    .btn-success {
        background: linear-gradient(135deg, #56ab2f, #a8e6cf);
        color: white;
    }

    .btn-danger {
        background: linear-gradient(135deg, #dc3545, #f8d7da);
        color: white;
    }

    .btn-warning {
        background: linear-gradient(135deg, #ffc107, #fff3cd);
        color: #333;
    }

    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
    }

    .btn-small {
        width: auto;
        padding: 8px 16px;
        font-size: 14px;
        margin: 0 5px 5px 0;
    }

    .tool-list {
        max-height: 350px;
        overflow-y: auto;
        margin-top: 15px;
    }

    .tool-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px;
        margin-bottom: 10px;
        background: white;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        border-left: 4px solid #667eea;
        transition: all 0.3s ease;
    }

    .tool-item:hover {
        transform: translateX(3px);
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
    }

    .tool-info {
        flex: 1;
    }

    .tool-name {
        font-weight: 600;
        color: #333;
        margin-bottom: 3px;
        font-size: 14px;
    }

    .tool-details {
        font-size: 11px;
        color: #666;
        margin-bottom: 2px;
    }

    .tool-status {
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 11px;
        font-weight: 600;
        text-align: center;
        min-width: 70px;
    }

    .status-available {
        background: #d4edda;
        color: #155724;
    }

    .status-checked-out {
        background: #f8d7da;
        color: #721c24;
    }

    .status-maintenance {
        background: #fff3cd;
        color: #856404;
    }

    .alert {
        padding: 12px;
        border-radius: 8px;
        margin-bottom: 15px;
        font-weight: 500;
        text-align: center;
        animation: slideDown 0.3s ease;
        font-size: 14px;
    }

    .alert-success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
    }

    .alert-error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
    }

    .alert-info {
        background: #d1ecf1;
        color: #0c5460;
        border: 1px solid #bee5eb;
    }

    @keyframes slideDown {
        from { opacity: 0; transform: translateY(-20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .search-box, .filter-box {
        width: 100%;
        padding: 12px;
        border: 2px solid #e9ecef;
        border-radius: 8px;
        font-size: 16px;
        margin-bottom: 10px;
        background: white;
    }

    .search-box:focus, .filter-box:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
    }

    .stats {
        display: flex;
        gap: 8px;
        margin-bottom: 15px;
        flex-wrap: wrap;
    }

    .stat {
        flex: 1;
        background: white;
        padding: 12px;
        border-radius: 8px;
        text-align: center;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        min-width: 80px;
    }

    .stat-number {
        font-size: 18px;
        font-weight: 700;
        color: #667eea;
        margin-bottom: 3px;
    }

    .stat-label {
        font-size: 10px;
        color: #666;
        font-weight: 600;
    }

    .camera-container {
        text-align: center;
        margin: 15px 0;
    }

    .camera-preview {
        max-width: 100%;
        border-radius: 8px;
        margin-bottom: 10px;
    }

    .barcode-scanner {
        background: #f8f9fa;
        border: 2px dashed #ccc;
        border-radius: 8px;
        padding: 20px;
        text-align: center;
        margin-bottom: 15px;
    }

    .maintenance-item {
        background: #fff3cd;
        border-left: 4px solid #ffc107;
        padding: 10px;
        margin-bottom: 10px;
        border-radius: 0 8px 8px 0;
    }

    .export-buttons {
        display: flex;
        gap: 10px;
        margin-bottom: 15px;
        flex-wrap: wrap;
    }

    .admin-actions {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 15px;
    }

    .admin-actions h3 {
        color: #333;
        margin-bottom: 10px;
        font-size: 16px;
    }

    .quick-actions {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        margin-bottom: 15px;
    }

    .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
    }

    .modal-content {
        background-color: white;
        margin: 15% auto;
        padding: 20px;
        border-radius: 10px;
        width: 90%;
        max-width: 400px;
    }

    .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
    }

    .close:hover {
        color: black;
    }

    .hidden {
        display: none;
    }

    @media (max-width: 480px) {
        .container {
            padding: 15px;
        }
        
        .tabs {
            font-size: 10px;
        }
        
        .tab {
            padding: 8px 4px;
            font-size: 10px;
        }
    }
</style>
```

</head>
<body>
    <div class="container">
        <!-- Login Screen -->
        <div id="login-screen" class="login-container">
            <div class="header">
                <h1>üîß Tool Manager Pro</h1>
                <p>Professional Tool Management System</p>
            </div>
            <form id="login-form">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" required placeholder="Enter username">
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" required placeholder="Enter password">
                </div>
                <button type="submit" class="btn btn-primary">Login</button>
            </form>
            <div style="margin-top: 15px; font-size: 12px; color: #666;">
                <p><strong>Demo Accounts:</strong></p>
                <p>User: user/user123</p>
                <p>Admin: admin/admin123</p>
            </div>
        </div>

```
    <!-- Main Application -->
    <div id="main-app" class="hidden">
        <div class="header">
            <h1>üîß Tool Manager Pro</h1>
            <p>Professional Tool Management</p>
        </div>

        <div class="user-info">
            <div>
                <span class="user-name" id="current-user"></span>
                <span class="user-role" id="user-role"></span>
            </div>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </div>

        <div class="tabs" id="main-tabs">
            <button class="tab active" onclick="showTab('checkout')">Check Out</button>
            <button class="tab" onclick="showTab('checkin')">Check In</button>
            <button class="tab" onclick="showTab('inventory')">Inventory</button>
            <button class="tab" onclick="showTab('maintenance')">Maintenance</button>
            <button class="tab" onclick="showTab('reports')">Reports</button>
        </div>

        <!-- Admin Tabs (only visible for admins) -->
        <div class="tabs hidden" id="admin-tabs">
            <button class="tab" onclick="showTab('admin')">Admin</button>
            <button class="tab" onclick="showTab('users')">Users</button>
            <button class="tab" onclick="showTab('database')">Database</button>
        </div>

        <div id="alert-container"></div>

        <!-- Check Out Tab -->
        <div id="checkout" class="tab-content active">
            <div class="barcode-scanner" onclick="scanBarcode()">
                üì∑ Tap to Scan Barcode/QR Code
            </div>
            
            <form id="checkout-form">
                <div class="form-group">
                    <label for="checkout-tool">Select Tool</label>
                    <select id="checkout-tool" required>
                        <option value="">Choose a tool...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="checkout-project">Project/Location</label>
                    <input type="text" id="checkout-project" placeholder="Project name or location" required>
                </div>
                <div class="form-group">
                    <label for="checkout-notes">Notes (Optional)</label>
                    <input type="text" id="checkout-notes" placeholder="Any special instructions">
                </div>
                <button type="submit" class="btn btn-primary">Check Out Tool</button>
            </form>
        </div>

        <!-- Check In Tab -->
        <div id="checkin" class="tab-content">
            <div class="barcode-scanner" onclick="scanBarcode()">
                üì∑ Tap to Scan Barcode/QR Code
            </div>

            <form id="checkin-form">
                <div class="form-group">
                    <label for="checkin-tool">Select Tool to Return</label>
                    <select id="checkin-tool" required>
                        <option value="">Choose a tool...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="checkin-condition">Tool Condition</label>
                    <select id="checkin-condition" required>
                        <option value="">Select condition...</option>
                        <option value="excellent">Excellent</option>
                        <option value="good">Good</option>
                        <option value="fair">Fair</option>
                        <option value="damaged">Damaged</option>
                        <option value="needs-repair">Needs Repair</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="checkin-photo">Photo (Optional)</label>
                    <button type="button" class="btn btn-warning btn-small" onclick="capturePhoto('checkin')">üì∑ Take Photo</button>
                    <div id="checkin-photo-preview"></div>
                </div>
                <div class="form-group">
                    <label for="checkin-notes">Notes</label>
                    <textarea id="checkin-notes" placeholder="Any issues, damage, or comments"></textarea>
                </div>
                <button type="submit" class="btn btn-success">Check In Tool</button>
            </form>
        </div>

        <!-- Inventory Tab -->
        <div id="inventory" class="tab-content">
            <div class="stats">
                <div class="stat">
                    <div class="stat-number" id="total-tools">0</div>
                    <div class="stat-label">Total</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="available-tools">0</div>
                    <div class="stat-label">Available</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="checked-out-tools">0</div>
                    <div class="stat-label">Out</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="maintenance-tools">0</div>
                    <div class="stat-label">Maintenance</div>
                </div>
            </div>

            <input type="text" class="search-box" id="search-tools" placeholder="üîç Search tools...">
            
            <select class="filter-box" id="filter-category">
                <option value="">All Categories</option>
                <option value="Power Tools">Power Tools</option>
                <option value="Hand Tools">Hand Tools</option>
                <option value="Electrical">Electrical</option>
                <option value="Measuring">Measuring</option>
                <option value="Safety">Safety</option>
            </select>

            <select class="filter-box" id="filter-status">
                <option value="">All Status</option>
                <option value="available">Available</option>
                <option value="checked-out">Checked Out</option>
                <option value="maintenance">Maintenance</option>
            </select>
            
            <div class="tool-list" id="tool-inventory"></div>
        </div>

        <!-- Maintenance Tab -->
        <div id="maintenance" class="tab-content">
            <div class="quick-actions">
                <button class="btn btn-warning btn-small" onclick="showScheduleMaintenance()">Schedule Maintenance</button>
                <button class="btn btn-primary btn-small" onclick="generateMaintenanceReport()">Generate Report</button>
            </div>

            <h3 style="margin-bottom: 10px; color: #333;">Upcoming Maintenance</h3>
            <div id="maintenance-schedule"></div>

            <h3 style="margin: 20px 0 10px 0; color: #333;">Tools Needing Attention</h3>
            <div id="maintenance-needed"></div>
        </div>

        <!-- Reports Tab -->
        <div id="reports" class="tab-content">
            <div class="export-buttons">
                <button class="btn btn-primary btn-small" onclick="exportToCSV()">üìä Export CSV</button>
                <button class="btn btn-success btn-small" onclick="exportToPDF()">üìÑ Export PDF</button>
                <button class="btn btn-warning btn-small" onclick="emailReport()">üìß Email Report</button>
            </div>

            <div class="form-group">
                <label for="report-type">Report Type</label>
                <select id="report-type" onchange="generateReport()">
                    <option value="summary">Summary Report</option>
                    <option value="checkout-history">Checkout History</option>
                    <option value="maintenance-log">Maintenance Log</option>
                    <option value="usage-stats">Usage Statistics</option>
                </select>
            </div>

            <div class="form-group">
                <label for="date-range">Date Range</label>
                <select id="date-range" onchange="generateReport()">
                    <option value="7">Last 7 Days</option>
                    <option value="30">Last 30 Days</option>
                    <option value="90">Last 90 Days</option>
                    <option value="365">Last Year</option>
                </select>
            </div>

            <div id="report-content"></div>
        </div>

        <!-- Admin Tab -->
        <div id="admin" class="tab-content">
            <div class="admin-actions">
                <h3>Tool Management</h3>
                <div class="quick-actions">
                    <button class="btn btn-primary btn-small" onclick="showAddTool()">‚ûï Add Tool</button>
                    <button class="btn btn-warning btn-small" onclick="bulkImport()">üì• Bulk Import</button>
                    <button class="btn btn-danger btn-small" onclick="bulkDelete()">üóëÔ∏è Bulk Delete</button>
                </div>
            </div>

            <div class="admin-actions">
                <h3>System Settings</h3>
                <div class="quick-actions">
                    <button class="btn btn-primary btn-small" onclick="backupDatabase()">üíæ Backup Data</button>
                    <button class="btn btn-warning btn-small" onclick="restoreDatabase()">üîÑ Restore Data</button>
                    <button class="btn btn-success btn-small" onclick="syncDatabase()">üîÑ Sync Database</button>
                </div>
            </div>

            <div class="form-group">
                <label>Database Connection Status</label>
                <div id="db-status" style="padding: 10px; border-radius: 5px; background: #f8f9fa;">
                    Status: <span id="db-connection">Checking...</span>
                </div>
            </div>
        </div>

        <!-- Users Tab -->
        <div id="users" class="tab-content">
            <button class="btn btn-primary btn-small" onclick="showAddUser()">‚ûï Add User</button>
            <div id="users-list"></div>
        </div>

        <!-- Database Tab -->
        <div id="database" class="tab-content">
            <div class="admin-actions">
                <h3>Database Operations</h3>
                <div class="form-group">
                    <label for="db-endpoint">API Endpoint URL</label>
                    <input type="url" id="db-endpoint" placeholder="https://your-api.com/api/tools" value="">
                </div>
                <div class="form-group">
                    <label for="api-key">API Key</label>
                    <input type="password" id="api-key" placeholder="Your API key">
                </div>
                <div class="quick-actions">
                    <button class="btn btn-primary btn-small" onclick="testConnection()">üîó Test Connection</button>
                    <button class="btn btn-success btn-small" onclick="syncToDatabase()">‚¨ÜÔ∏è Sync to Database</button>
                    <button class="btn btn-warning btn-small" onclick="loadFromDatabase()">‚¨áÔ∏è Load from Database</button>
                </div>
            </div>

            <div class="admin-actions">
                <h3>Database Schema</h3>
                <pre id="db-schema" style="background: #f8f9fa; padding: 10px; border-radius: 5px; font-size: 12px; overflow-x: auto;">
```

{
‚Äútools‚Äù: [
{
‚Äúid‚Äù: ‚Äúnumber‚Äù,
‚Äúname‚Äù: ‚Äústring‚Äù,
‚Äútype‚Äù: ‚Äústring‚Äù,
‚Äúmodel‚Äù: ‚Äústring‚Äù,
‚Äúbarcode‚Äù: ‚Äústring‚Äù,
‚Äústatus‚Äù: ‚Äúavailable|checked-out|maintenance‚Äù,
‚ÄúcheckedOutBy‚Äù: ‚Äústring|null‚Äù,
‚ÄúcheckedOutDate‚Äù: ‚ÄúISO date|null‚Äù,
‚Äúproject‚Äù: ‚Äústring|null‚Äù,
‚Äúcondition‚Äù: ‚Äústring‚Äù,
‚ÄúlastMaintenance‚Äù: ‚ÄúISO date‚Äù,
‚ÄúnextMaintenance‚Äù: ‚ÄúISO date‚Äù,
‚Äúphotos‚Äù: [‚Äúarray of base64 strings‚Äù],
‚Äúnotes‚Äù: ‚Äústring‚Äù
}
],
‚Äúusers‚Äù: [
{
‚Äúid‚Äù: ‚Äúnumber‚Äù,
‚Äúusername‚Äù: ‚Äústring‚Äù,
‚Äúrole‚Äù: ‚Äúuser|admin‚Äù,
‚Äúemail‚Äù: ‚Äústring‚Äù,
‚Äúactive‚Äù: ‚Äúboolean‚Äù
}
],
‚Äútransactions‚Äù: [
{
‚Äúid‚Äù: ‚Äúnumber‚Äù,
‚ÄútoolId‚Äù: ‚Äúnumber‚Äù,
‚ÄúuserId‚Äù: ‚Äústring‚Äù,
‚Äúaction‚Äù: ‚Äúcheckout|checkin|maintenance‚Äù,
‚Äútimestamp‚Äù: ‚ÄúISO date‚Äù,
‚Äúproject‚Äù: ‚Äústring‚Äù,
‚Äúnotes‚Äù: ‚Äústring‚Äù
}
]
}
</pre>
</div>
</div>
</div>
</div>

```
<!-- Modals -->
<div id="photo-modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('photo-modal')">&times;</span>
        <h3>Capture Photo</h3>
        <div class="camera-container">
            <video id="camera" width="320" height="240" autoplay></video>
            <canvas id="canvas" width="320" height="240" style="display:none;"></canvas>
        </div>
        <button class="btn btn-primary" onclick="takePhoto()">üì∑ Take Photo</button>
        <button class="btn btn-danger" onclick="closeCamera()">Cancel</button>
    </div>
</div>

<div id="add-tool-modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('add-tool-modal')">&times;</span>
        <h3>Add New Tool</h3>
        <form id="add-tool-form">
            <div class="form-group">
                <label>Tool Name</label>
                <input type="text" id="new-tool-name" required>
            </div>
            <div class="form-group">
                <label>Category</label>
                <select id="new-tool-type" required>
                    <option value="">Select category...</option>
                    <option value="Power Tools">Power Tools</option>
                    <option value="Hand Tools">Hand Tools</option>
                    <option value="Electrical">Electrical</option>
                    <option value="Measuring">Measuring</option>
                    <option value="Safety">Safety</option>
                </select>
            </div>
            <div class="form-group">
                <label>Model/Brand</label>
                <input type="text" id="new-tool-model" required>
            </div>
            <div class="form-group">
                <label>Barcode/Serial</label>
                <input type="text" id="new-tool-barcode">
            </div>
            <button type="submit" class="btn btn-primary">Add Tool</button>
        </form>
    </div>
</div>

<script>
    // Global state
    let currentUser = null;
    let userRole = null;
    let tools = [
        { id: 1, name: "Power Drill", type: "Power Tools", model: "DeWalt DCD771", barcode: "DW001", status: "available", checkedOutBy: null, project: null, checkoutDate: null, condition: "good", lastMaintenance: "2024-01-15", nextMaintenance: "2024-07-15", photos: [], notes: "" },
        { id: 2, name: "Impact Driver", type: "Power Tools", model: "Milwaukee M18", barcode: "MW002", status: "available", checkedOutBy: null, project: null, checkoutDate: null, condition: "good", lastMaintenance: "2024-02-01", nextMaintenance: "2024-08-01", photos: [], notes: "" },
        { id: 3, name: "Circular Saw", type: "Power Tools", model: "Makita 5007MG", barcode: "MK003", status: "available", checkedOutBy: null, project: null, checkoutDate: null, condition: "excellent", lastMaintenance: "2024-01-20", nextMaintenance: "2024-07-20", photos: [], notes: "" },
        { id: 4, name: "Socket Set", type: "Hand Tools", model: "Craftsman 42pc", barcode: "CR004", status: "available", checkedOutBy: null, project: null, checkoutDate: null, condition: "good", lastMaintenance: "2024-03-01", nextMaintenance: "2024-09-01", photos: [], notes: "" },
        { id: 5, name: "Multimeter", type: "Electrical", model: "Fluke 117", barcode: "FL005", status: "available", checkedOutBy: null, project: null, checkoutDate: null, condition: "excellent", lastMaintenance: "2024-02-15", nextMaintenance: "2024-08-15", photos: [], notes: "" },
        { id: 6, name: "Hammer", type: "Hand Tools", model: "Estwing 16oz", barcode: "ES006", status: "available", checkedOutBy: null, project: null, checkoutDate: null, condition: "good", lastMaintenance: "2024-01-10", nextMaintenance: "2024-07-10", photos: [], notes: "" },
        { id: 7, name: "Screwdriver Set", type: "Hand Tools", model: "Klein 32pc", barcode: "KL007", status: "available", checkedOutBy: null, project: null, checkoutDate: null, condition: "good", lastMaintenance: "2024-02-20", nextMaintenance: "2024-08-20", photos: [], notes: "" },
        { id: 8, name: "Wire Strippers", type: "Electrical", model: "Klein 11057", barcode: "KL008", status: "available", checkedOutBy: null, project: null, checkoutDate: null, condition: "good", lastMaintenance: "2024-03-05", nextMaintenance: "2024-09-05", photos: [], notes: "" },
        { id: 9, name: "Pliers Set", type: "Hand Tools", model: "Channellock 3pc", barcode: "CH009", status: "available", checkedOutBy: null, project: null, checkoutDate: null, condition: "fair", lastMaintenance: "2024-01-25", nextMaintenance: "2024-07-25", photos: [], notes: "" },
        { id: 10, name: "Level", type: "Measuring", model: "Stanley 24in", barcode: "ST010", status: "available", checkedOutBy: null, project: null, checkoutDate: null, condition: "excellent", lastMaintenance: "2024-02-10", nextMaintenance: "2024-08-10", photos: [], notes: "" },
        { id: 11, name: "Safety Glasses", type: "Safety", model: "3M SecureFit", barcode: "3M011", status: "maintenance", checkedOutBy: null, project: null, checkoutDate: null, condition: "needs-repair", lastMaintenance: "2024-03-01", nextMaintenance: "2024-09-01", photos: [], notes: "Scratched lenses" },
        { id: 12, name: "Hard Hat", type: "Safety", model: "MSA V-Gard", barcode: "MS012", status: "available", checkedOutBy: null, project: null, checkoutDate: null, condition: "good", lastMaintenance: "2024-01-30", nextMaintenance: "2024-07-30", photos: [], notes: "" }
    ];

    let users = [
        { id: 1, username: "admin", password: "admin123", role: "admin", email: "admin@company.com", active: true },
        { id: 2, username: "user", password: "user123", role: "user", email: "user@company.com", active: true },
        { id: 3, username: "john.doe", password: "pass123", role: "user", email: "john.doe@company.com", active: true },
        { id: 4, username: "jane.smith", password: "pass456", role: "user", email: "jane.smith@company.com", active: true }
    ];

    let transactions = [];
    let currentPhotoContext = null;
    let cameraStream = null;

    // Initialize the app
    document.addEventListener('DOMContentLoaded', function() {
        checkAuthStatus();
        
        // Event listeners
        document.getElementById('login-form').addEventListener('submit', handleLogin);
        document.getElementById('checkout-form').addEventListener('submit', handleCheckout);
        document.getElementById('checkin-form').addEventListener('submit', handleCheckin);
        document.getElementById('add-tool-form').addEventListener('submit', handleAddTool);
        document.getElementById('search-tools').addEventListener('input', updateInventory);
        document.getElementById('filter-category').addEventListener('change', updateInventory);
        document.getElementById('filter-status').addEventListener('change', updateInventory);
    });

    function checkAuthStatus() {
        // In a real app, check for valid session/token
        const loginScreen = document.getElementById('login-screen');
        const mainApp = document.getElementById('main-app');
        
        if (currentUser) {
            loginScreen.classList.add('hidden');
            mainApp.classList.remove('hidden');
            updateUserInterface();
        } else {
            loginScreen.classList.remove('hidden');
            mainApp.classList.add('hidden');
        }
    }

    function handleLogin(e) {
        e.preventDefault();
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        
        const user = users.find(u => u.username === username && u.password === password && u.active);
        
        if (user) {
            currentUser = user.username;
            userRole = user.role;
            showAlert('Login successful!', 'success');
            checkAuthStatus();
        } else {
            showAlert('Invalid credentials!', 'error');
        }
    }

    function logout() {
        currentUser = null;
        userRole = null;
        document.getElementById('login-form').reset();
        checkAuthStatus();
    }

    function updateUserInterface() {
        document.getElementById('current-user').textContent = currentUser;
        document.getElementById('user-role').textContent = userRole.toUpperCase();
        
        const adminTabs = document.getElementById('admin-tabs');
        if (userRole === 'admin') {
            adminTabs.classList.remove('hidden');
        } else {
            adminTabs.classList.add('hidden');
        }
        
        updateDropdowns();
        updateInventory();
        updateStats();
        updateMaintenanceSchedule();
    }

    function showTab(tabName) {
        // Hide all tab contents
        const contents = document.querySelectorAll('.tab-content');
        contents.forEach(content => content.classList.remove('active'));

        // Remove active class from all tabs
        const tabs = document.querySelectorAll('.tab');
        tabs.forEach(tab => tab.classList.remove('active'));

        // Show selected tab content
        const targetTab = document.getElementById(tabName);
        if (targetTab) {
            targetTab.classList.add('active');
            event.target.classList.add('active');
        }

        // Update content when switching tabs
        updateDropdowns();
        updateInventory();
        updateStats();
        
        if (tabName === 'maintenance') {
            updateMaintenanceSchedule();
        } else if (tabName === 'reports') {
            generateReport();
        } else if (tabName === 'users' && userRole === 'admin') {
            updateUsersList();
        } else if (tabName === 'database' && userRole === 'admin') {
            checkDatabaseConnection();
        }
    }

    function updateDropdowns() {
        const checkoutSelect = document.getElementById('checkout-tool');
        const checkinSelect = document.getElementById('checkin-tool');

        // Clear existing options
        checkoutSelect.innerHTML = '<option value="">Choose a tool...</option>';
        checkinSelect.innerHTML = '<option value="">Choose a tool...</option>';

        tools.forEach(tool => {
            if (tool.status === 'available') {
                const option = document.createElement('option');
                option.value = tool.id;
                option.textContent = `${tool.name} (${tool.model}) - ${tool.barcode}`;
                checkoutSelect.appendChild(option);
            }

            if (tool.status === 'checked-out') {
                const option = document.createElement('option');
                option.value = tool.id;
                option.textContent = `${tool.name} (${tool.model}) - ${tool.checkedOutBy}`;
                checkinSelect.appendChild(option);
            }
        });
    }

    function updateInventory() {
        const inventory = document.getElementById('tool-inventory');
        const searchTerm = document.getElementById('search-tools').value.toLowerCase();
        const categoryFilter = document.getElementById('filter-category').value;
        const statusFilter = document.getElementById('filter-status').value;
        
        inventory.innerHTML = '';

        const filteredTools = tools.filter(tool => {
            const matchesSearch = tool.name.toLowerCase().includes(searchTerm) ||
                                tool.type.toLowerCase().includes(searchTerm) ||
                                tool.model.toLowerCase().includes(searchTerm) ||
                                tool.barcode.toLowerCase().includes(searchTerm);
            const matchesCategory = !categoryFilter || tool.type === categoryFilter;
            const matchesStatus = !statusFilter || tool.status === statusFilter;
            
            return matchesSearch && matchesCategory && matchesStatus;
        });

        filteredTools.forEach(tool => {
            const toolItem = document.createElement('div');
            toolItem.className = 'tool-item';
            
            let statusClass, statusText;
            switch(tool.status) {
                case 'available':
                    statusClass = 'status-available';
                    statusText = 'Available';
                    break;
                case 'checked-out':
                    statusClass = 'status-checked-out';
                    statusText = 'Checked Out';
                    break;
                case 'maintenance':
                    statusClass = 'status-maintenance';
                    statusText = 'Maintenance';
                    break;
                default:
                    statusClass = 'status-available';
                    statusText = 'Unknown';
            }
            
            toolItem.innerHTML = `
                <div class="tool-info">
                    <div class="tool-name">${tool.name}</div>
                    <div class="tool-details">${tool.type} | ${tool.model} | ${tool.barcode}</div>
                    <div class="tool-details">Condition: ${tool.condition.charAt(0).toUpperCase() + tool.condition.slice(1)}</div>
                    ${tool.status === 'checked-out' ? `<div class="tool-details">By: ${tool.checkedOutBy} | ${tool.project}</div>` : ''}
                    ${tool.status === 'maintenance' ? `<div class="tool-details">Next: ${formatDate(tool.nextMaintenance)}</div>` : ''}
                </div>
                <div class="tool-status ${statusClass}">${statusText}</div>
            `;
            
            inventory.appendChild(toolItem);
        });

        if (filteredTools.length === 0) {
            inventory.innerHTML = '<div style="text-align: center; color: #666; padding: 20px;">No tools found</div>';
        }
    }

    function updateStats() {
        const totalTools = tools.length;
        const availableTools = tools.filter(t => t.status === 'available').length;
        const checkedOutTools = tools.filter(t => t.status === 'checked-out').length;
        const maintenanceTools = tools.filter(t => t.status === 'maintenance').length;

        document.getElementById('total-tools').textContent = totalTools;
        document.getElementById('available-tools').textContent = availableTools;
        document.getElementById('checked-out-tools').textContent = checkedOutTools;
        document.getElementById('maintenance-tools').textContent = maintenanceTools;
    }

    function updateMaintenanceSchedule() {
        const scheduleContainer = document.getElementById('maintenance-schedule');
        const needsAttentionContainer = document.getElementById('maintenance-needed');
        
        scheduleContainer.innerHTML = '';
        needsAttentionContainer.innerHTML = '';
        
        const today = new Date();
        const upcomingMaintenance = tools.filter(tool => {
            const nextMaintenance = new Date(tool.nextMaintenance);
            const daysUntil = Math.ceil((nextMaintenance - today) / (1000 * 60 * 60 * 24));
            return daysUntil <= 30 && daysUntil >= 0;
        });
        
        const needsAttention = tools.filter(tool => 
            tool.condition === 'needs-repair' || tool.condition === 'damaged'
        );
        
        upcomingMaintenance.forEach(tool => {
            const nextMaintenance = new Date(tool.nextMaintenance);
            const daysUntil = Math.ceil((nextMaintenance - today) / (1000 * 60 * 60 * 24));
            
            const maintenanceItem = document.createElement('div');
            maintenanceItem.className = 'maintenance-item';
            maintenanceItem.innerHTML = `
                <div><strong>${tool.name}</strong> - ${tool.model}</div>
                <div>Due in ${daysUntil} days (${formatDate(tool.nextMaintenance)})</div>
            `;
            scheduleContainer.appendChild(maintenanceItem);
        });
        
        needsAttention.forEach(tool => {
            const attentionItem = document.createElement('div');
            attentionItem.className = 'maintenance-item';
            attentionItem.style.borderLeftColor = '#dc3545';
            attentionItem.innerHTML = `
                <div><strong>${tool.name}</strong> - ${tool.model}</div>
                <div>Condition: ${tool.condition} | ${tool.notes || 'No notes'}</div>
            `;
            needsAttentionContainer.appendChild(attentionItem);
        });
        
        if (upcomingMaintenance.length === 0) {
            scheduleContainer.innerHTML = '<div style="color: #666; text-align: center; padding: 10px;">No upcoming maintenance scheduled</div>';
        }
        
        if (needsAttention.length === 0) {
            needsAttentionContainer.innerHTML = '<div style="color: #666; text-align: center; padding: 10px;">All tools in good condition</div>';
        }
    }

    function handleCheckout(e) {
        e.preventDefault();
        
        const toolId = parseInt(document.getElementById('checkout-tool').value);
        const project = document.getElementById('checkout-project').value;
        const notes = document.getElementById('checkout-notes').value;
        
        const tool = tools.find(t => t.id === toolId);
        if (tool && tool.status === 'available') {
            tool.status = 'checked-out';
            tool.checkedOutBy = currentUser;
            tool.project = project;
            tool.checkoutDate = new Date().toISOString();
            
            // Add transaction record
            transactions.push({
                id: transactions.length + 1,
                toolId: toolId,
                userId: currentUser,
                action: 'checkout',
                timestamp: new Date().toISOString(),
                project: project,
                notes: notes
            });
            
            showAlert(`${tool.name} checked out successfully!`, 'success');
            document.getElementById('checkout-form').reset();
            updateUserInterface();
        } else {
            showAlert('Tool is not available for checkout.', 'error');
        }
    }

    function handleCheckin(e) {
        e.preventDefault();
        
        const toolId = parseInt(document.getElementById('checkin-tool').value);
        const condition = document.getElementById('checkin-condition').value;
        const notes = document.getElementById('checkin-notes').value;
        
        const tool = tools.find(t => t.id === toolId);
        if (tool && tool.status === 'checked-out') {
            const previousUser = tool.checkedOutBy;
            tool.status = condition === 'needs-repair' || condition === 'damaged' ? 'maintenance' : 'available';
            tool.checkedOutBy = null;
            tool.project = null;
            tool.checkoutDate = null;
            tool.condition = condition;
            tool.notes = notes || tool.notes;
            
            // Add transaction record
            transactions.push({
                id: transactions.length + 1,
                toolId: toolId,
                userId: currentUser,
                action: 'checkin',
                timestamp: new Date().toISOString(),
                project: null,
                notes: notes
            });
            
            showAlert(`${tool.name} checked in successfully from ${previousUser}!`, 'success');
            document.getElementById('checkin-form').reset();
            updateUserInterface();
        } else {
            showAlert('Error checking in tool.', 'error');
        }
    }

    function scanBarcode() {
        showAlert('Barcode scanning would integrate with device camera API in production', 'info');
        // In production, this would use:
        // - QuaggaJS for barcode scanning
        // - ZXing for QR codes
        // - Device camera API
    }

    function capturePhoto(context) {
        currentPhotoContext = context;
        document.getElementById('photo-modal').style.display = 'block';
        
        navigator.mediaDevices.getUserMedia({ video: true })
            .then(stream => {
                cameraStream = stream;
                document.getElementById('camera').srcObject = stream;
            })
            .catch(err => {
                showAlert('Camera access denied or not available', 'error');
                closeModal('photo-modal');
            });
    }

    function takePhoto() {
        const video = document.getElementById('camera');
        const canvas = document.getElementById('canvas');
        const context = canvas.getContext('2d');
        
        context.drawImage(video, 0, 0, 320, 240);
        const imageData = canvas.toDataURL('image/jpeg');
        
        // Display photo preview
        const previewContainer = document.getElementById(`${currentPhotoContext}-photo-preview`);
        previewContainer.innerHTML = `<img src="${imageData}" style="max-width: 100%; border-radius: 5px; margin-top: 10px;">`;
        
        showAlert('Photo captured successfully!', 'success');
        closeCamera();
    }

    function closeCamera() {
        if (cameraStream) {
            cameraStream.getTracks().forEach(track => track.stop());
            cameraStream = null;
        }
        closeModal('photo-modal');
    }

    function showAddTool() {
        document.getElementById('add-tool-modal').style.display = 'block';
    }

    function handleAddTool(e) {
        e.preventDefault();
        
        const name = document.getElementById('new-tool-name').value;
        const type = document.getElementById('new-tool-type').value;
        const model = document.getElementById('new-tool-model').value;
        const barcode = document.getElementById('new-tool-barcode').value || `AUTO${Date.now()}`;
        
        const newTool = {
            id: Math.max(...tools.map(t => t.id)) + 1,
            name: name,
            type: type,
            model: model,
            barcode: barcode,
            status: 'available',
            checkedOutBy: null,
            project: null,
            checkoutDate: null,
            condition: 'excellent',
            lastMaintenance: new Date().toISOString().split('T')[0],
            nextMaintenance: new Date(Date.now() + 180 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], // 6 months
            photos: [],
            notes: ''
        };
        
        tools.push(newTool);
        showAlert(`Tool "${name}" added successfully!`, 'success');
        document.getElementById('add-tool-form').reset();
        closeModal('add-tool-modal');
        updateUserInterface();
    }

    function generateReport() {
        const reportType = document.getElementById('report-type').value;
        const dateRange = parseInt(document.getElementById('date-range').value);
        const reportContent = document.getElementById('report-content');
        
        let report = '';
        const cutoffDate = new Date(Date.now() - dateRange * 24 * 60 * 60 * 1000);
        
        switch(reportType) {
            case 'summary':
                report = `
                    <h4>Tool Inventory Summary</h4>
                    <p>Total Tools: ${tools.length}</p>
                    <p>Available: ${tools.filter(t => t.status === 'available').length}</p>
                    <p>Checked Out: ${tools.filter(t => t.status === 'checked-out').length}</p>
                    <p>In Maintenance: ${tools.filter(t => t.status === 'maintenance').length}</p>
                    <p>Report Generated: ${new Date().toLocaleDateString()}</p>
                `;
                break;
            case 'checkout-history':
                const checkoutHistory = transactions.filter(t => 
                    t.action === 'checkout' && new Date(t.timestamp) > cutoffDate
                );
                report = `
                    <h4>Checkout History (Last ${dateRange} days)</h4>
                    <p>Total Checkouts: ${checkoutHistory.length}</p>
                    ${checkoutHistory.map(t => {
                        const tool = tools.find(tool => tool.id === t.toolId);
                        return `<div style="margin-bottom: 10px; padding: 10px; background: #f8f9fa; border-radius: 5px;">
                            <strong>${tool ? tool.name : 'Unknown Tool'}</strong><br>
                            User: ${t.userId}<br>
                            Project: ${t.project}<br>
                            Date: ${new Date(t.timestamp).toLocaleDateString()}
                        </div>`;
                    }).join('')}
                `;
                break;
            case 'maintenance-log':
                const maintenanceItems = tools.filter(t => t.condition !== 'excellent' && t.condition !== 'good');
                report = `
                    <h4>Maintenance Log</h4>
                    <p>Tools Requiring Attention: ${maintenanceItems.length}</p>
                    ${maintenanceItems.map(tool => `
                        <div style="margin-bottom: 10px; padding: 10px; background: #f8f9fa; border-radius: 5px;">
                            <strong>${tool.name}</strong><br>
                            Condition: ${tool.condition}<br>
                            Last Maintenance: ${formatDate(tool.lastMaintenance)}<br>
                            Next Maintenance: ${formatDate(tool.nextMaintenance)}<br>
                            Notes: ${tool.notes || 'None'}
                        </div>
                    `).join('')}
                `;
                break;
            case 'usage-stats':
                const usageStats = tools.map(tool => {
                    const toolTransactions = transactions.filter(t => t.toolId === tool.id);
                    return {
                        name: tool.name,
                        checkouts: toolTransactions.filter(t => t.action === 'checkout').length,
                        status: tool.status
                    };
                }).sort((a, b) => b.checkouts - a.checkouts);
                
                report = `
                    <h4>Usage Statistics (Last ${dateRange} days)</h4>
                    <p>Most Used Tools:</p>
                    ${usageStats.slice(0, 10).map((stat, index) => `
                        <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px;">
                            ${index + 1}. <strong>${stat.name}</strong><br>
                            Checkouts: ${stat.checkouts} | Status: ${stat.status}
                        </div>
                    `).join('')}
                `;
                break;
        }
        
        reportContent.innerHTML = report;
    }

    function exportToCSV() {
        let csv = 'Tool Name,Type,Model,Barcode,Status,Condition,Checked Out By,Project,Last Maintenance,Next Maintenance\n';
        
        tools.forEach(tool => {
            csv += `"${tool.name}","${tool.type}","${tool.model}","${tool.barcode}","${tool.status}","${tool.condition}","${tool.checkedOutBy || ''}","${tool.project || ''}","${tool.lastMaintenance}","${tool.nextMaintenance}"\n`;
        });
        
        downloadFile(csv, 'tool_inventory.csv', 'text/csv');
        showAlert('CSV export completed!', 'success');
    }

    function exportToPDF() {
        showAlert('PDF export would use jsPDF library in production', 'info');
        // In production, integrate jsPDF library
    }

    function emailReport() {
        showAlert('Email functionality would integrate with backend email service', 'info');
        // In production, integrate with backend email service
    }

    function downloadFile(content, filename, contentType) {
        const blob = new Blob([content], { type: contentType });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.style.display = 'none';
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        window.URL.revokeObjectURL(url);
        document.body.removeChild(a);
    }

    // Database Operations
    function testConnection() {
        const endpoint = document.getElementById('db-endpoint').value;
        const apiKey = document.getElementById('api-key').value;
        
        if (!endpoint) {
            showAlert('Please enter API endpoint URL', 'error');
            return;
        }
        
        showAlert('Testing connection...', 'info');
        
        // Simulate API call
        setTimeout(() => {
            showAlert('Connection test successful!', 'success');
            document.getElementById('db-connection').textContent = 'Connected';
            document.getElementById('db-status').style.background = '#d4edda';
        }, 2000);
    }

    function syncToDatabase() {
        const endpoint = document.getElementById('db-endpoint').value;
        const apiKey = document.getElementById('api-key').value;
        
        if (!endpoint) {
            showAlert('Please configure database connection first', 'error');
            return;
        }
        
        // In production, this would make actual API calls:
        /*
        fetch(endpoint + '/sync', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': 'Bearer ' + apiKey
            },
            body: JSON.stringify({
                tools: tools,
                users: users.map(u => ({...u, password: undefined})), // Don't sync passwords
                transactions: transactions
            })
        }).then(response => response.json())
          .then(data => showAlert('Data synced successfully!', 'success'))
          .catch(error => showAlert('Sync failed: ' + error.message, 'error'));
        */
        
        showAlert('Data would be synced to database in production', 'info');
    }

    function loadFromDatabase() {
        const endpoint = document.getElementById('db-endpoint').value;
        const apiKey = document.getElementById('api-key').value;
        
        if (!endpoint) {
            showAlert('Please configure database connection first', 'error');
            return;
        }
        
        // In production:
        /*
        fetch(endpoint + '/tools', {
            headers: {
                'Authorization': 'Bearer ' + apiKey
            }
        }).then(response => response.json())
          .then(data => {
              tools = data.tools || [];
              updateUserInterface();
              showAlert('Data loaded from database!', 'success');
          })
          .catch(error => showAlert('Load failed: ' + error.message, 'error'));
        */
        
        showAlert('Data would be loaded from database in production', 'info');
    }

    function checkDatabaseConnection() {
        document.getElementById('db-connection').textContent = 'Disconnected (Demo Mode)';
        document.getElementById('db-status').style.background = '#f8d7da';
    }

    function updateUsersList() {
        const usersList = document.getElementById('users-list');
        usersList.innerHTML = '';
        
        users.forEach(user => {
            const userItem = document.createElement('div');
            userItem.className = 'tool-item';
            userItem.innerHTML = `
                <div class="tool-info">
                    <div class="tool-name">${user.username}</div>
                    <div class="tool-details">${user.email} | Role: ${user.role}</div>
                </div>
                <div class="tool-status ${user.active ? 'status-available' : 'status-maintenance'}">
                    ${user.active ? 'Active' : 'Inactive'}
                </div>
            `;
            usersList.appendChild(userItem);
        });
    }

    // Utility functions
    function showAlert(message, type) {
        const alertContainer = document.getElementById('alert-container');
        const alert = document.createElement('div');
        alert.className = `alert alert-${type}`;
        alert.textContent = message;
        
        alertContainer.innerHTML = '';
        alertContainer.appendChild(alert);
        
        setTimeout(() => {
            alertContainer.innerHTML = '';
        }, 5000);
    }

    function formatDate(dateString) {
        return new Date(dateString).toLocaleDateString();
    }

    function closeModal(modalId) {
        document.getElementById(modalId).style.display = 'none';
    }

    // Placeholder functions for admin features
    function showScheduleMaintenance() {
        showAlert('Maintenance scheduling modal would open here', 'info');
    }

    function generateMaintenanceReport() {
        showAlert('Maintenance report generated! (Demo)', 'success');
    }

    function bulkImport() {
        showAlert('Bulk import functionality would allow CSV/Excel file upload', 'info');
    }

    function bulkDelete() {
        showAlert('Bulk delete functionality with multi-select would be available', 'info');
    }

    function backupDatabase() {
        const backup = {
            tools: tools,
            users: users.map(u => ({...u, password: undefined})),
            transactions: transactions,
            timestamp: new Date().toISOString()
        };
        
        downloadFile(JSON.stringify(backup, null, 2), 'tool_manager_backup.json', 'application/json');
        showAlert('Database backup downloaded!', 'success');
    }

    function restoreDatabase() {
        showAlert('Database restore would allow uploading backup file', 'info');
    }

    function syncDatabase() {
        showAlert('Database sync with remote server initiated', 'info');
    }

    function showAddUser() {
        showAlert('Add user modal would open here with form fields', 'info');
    }

    // Initialize on load
    updateStats();
</script>
```

</body>
</html>
